<!DOCTYPE HTML>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>Epsilon Mobile Framework - Version 2.0</title>
    <link href="styles/style.css" rel="stylesheet" type="text/css">
    <link href="styles/framework.css" rel="stylesheet" type="text/css">
    <link href="styles/owl.carousel.css" rel="stylesheet" type="text/css">
    <link href="styles/owl.theme.css" rel="stylesheet" type="text/css">
    <link href="styles/swipebox.css" rel="stylesheet" type="text/css">
    <link href="styles/colorbox.css" rel="stylesheet" type="text/css">
    <style>
        .star
        {
            display: inline;
            background-image: url(../images/misc/facebook.png);
            width: 30px;
            margin: 0px 0px 0px 47px;
        }

        .submenu-nav-items a {
            padding-left: 20px !important;
            padding-top: 10px !important;
            padding-bottom: 10px !important;
            border-bottom: solid 1px rgba(0,0,0,0.1) !important;
        }

        .vinculo_derecha {
            float: right;
            padding-right: 1%;
        }

        .vinculo_izquierda {
            float: left;
            padding-left: 1%;
            display: none;
        }
    </style>

    <script type="text/javascript" src="scripts/jquery.js"></script>
    <script type="text/javascript" src="scripts/jqueryui.js"></script>
    <script type="text/javascript" src="scripts/owl.carousel.min.js"></script>
    <script type="text/javascript" src="scripts/jquery.swipebox.js"></script>
    <script type="text/javascript" src="scripts/colorbox.js"></script>
    <script type="text/javascript" src="scripts/snap.js"></script>
    <script type="text/javascript" src="scripts/contact.js"></script>
    <script type="text/javascript" src="scripts/custom.js"></script>
    <script type="text/javascript" src="scripts/framework.js"></script>
    <script type="text/javascript" src="scripts/framework.launcher.js"></script>
    <script type="text/javascript" src="scripts/bd.js"></script>

    <script>
        $(document).ready(function () {
            if (doesConnectionExist()) {
                $("#label-internet-connection").text("Online");
                $("#div-internet-connection").css("background-color", "#80d580");
            } else {
                $("#label-internet-connection").text("Offline");
                $("#div-internet-connection").css("background-color", "#ec8787");
            }
        });

        function consultarVacante() {
            var db = window.openDatabase("bd_vacantes", "1.0", "Vacantes", 200000);
            db.transaction(consultar_listaVacantes, errorConsultarVacantes, function () {
                console.log("Consultó las vacantes")
            });
        }

        function consultar_listaVacantes(tx) {
            tx.executeSql("SELECT * FROM vacantes", [], validar_listadoVacantes, function (error) {
                console.log("Error consultado el listado de vacantes: " + error)
            });
        }

        function validar_listadoVacantes(tx, results) {
            var len = results.rows.length;
            if (len > 0) {

                for (var i = 0; i < len; i++) {
                    var rutaEstrella = "images/estrella_vacia.png";
                    var metodoFavorito = 'agregarFavoritos(' + val['ID'] + ',\'' + val['Titulo'] + '\',\'' + val['Empleador'] + '\',\'' + nom_mun + '\',\'' + val['Num_vacantes'] + '\',\'' + val['Cargo'] + '\',\'' + val['Sector'] + '\',\'' + val['Profesion'] + '\',\'' + nom_sal + '\',\'' + nom_exp + '\',\'' + nom_niv + '\',\'' + val['Descripcion'] + '\')';
                    var textoFavorita = "Agregar a favoritas";
                    if (localStorage.getItem('vacantesGuardadas')) {
                        if (vacantesGuardadas.indexOf("id" + val['ID']) == -1) {
                            rutaEstrella = "images/estrella_vacia.png";
                        }
                        else {
                            rutaEstrella = "images/estrella_llena.png";
                            metodoFavorito = "yaAgregado()";
                            textoFavorita = "Agregada a favoritas";
                        }
                    }
                    texto += '<div class="container">' +
                            '<div class="toggle-2">' +
                                '<a href="#" class="deploy-toggle-2 toggle-2">' +
                                    results.rows.item(i).titulo + '<label style="font-weight: bolder; font-size: 15px; color: black;">Vence en ' + results.rows.item(i).titulo + ' días</label>' +
                                '</a>' +
                            '<div class="toggle-content">' +
                                '<p style="text-align:justify;">' +
                                    '<label>' +
                                        'Fecha Publicación: ' + results.rows.item(i).fecha_publicacion + '</label>' +
                                        'Fecha Vencimiento: ' + results.rows.item(i).fecha_vencimiento + '</label><br /><br />' +
                                     +
                                '</p>' +
                                '<div class="toggle-content">' +
                                    '<p><strong>Datos del Empleador:</strong></p>' +
                                    '<div class="one-half-responsive ">' +
                                        '<div class="submenu-navigation">' +
                                            '<div class="submenu-nav-items" style="overflow: hidden; display: block;"></div>' +
                                            '<a href="#" style="border-top: solid 1px rgba(0,0,0,0.1); padding-left: 20px !important; padding-top: 10px !important; padding-bottom: 10px !important; border-bottom: solid 1px rgba(0,0,0,0.1) !important;">' +
                                                '<ul style="margin-bottom:0px;" class="icon-list">' +
                                                    '<li class="right-list">Empleador: ' + val['Empleador'] + ' </li>' +
                                                '</ul>' +
                                            '</a>' +
                                            '<a href="#" style="border-top: solid 1px rgba(0,0,0,0.1); padding-left: 20px !important; padding-top: 10px !important; padding-bottom: 10px !important; border-bottom: solid 1px rgba(0,0,0,0.1) !important;">' +
                                                '<ul style="margin-bottom:0px;" class="icon-list">' +
                                                    '<li class="right-list">Ciudad: ' + nom_mun + ' </li>' +
                                                '</ul>' +
                                            '</a>' +
                                            '<a href="#" style="border-top: solid 1px rgba(0,0,0,0.1); padding-left: 20px !important; padding-top: 10px !important; padding-bottom: 10px !important; border-bottom: solid 1px rgba(0,0,0,0.1) !important;">' +
                                                '<ul style="margin-bottom:0px;" class="icon-list">' +
                                                    '<li class="right-list">Número de vacantes: ' + val['Num_vacantes'] + ' </li>' +
                                                '</ul>' +
                                            '</a>' +
                                            '<a href="#" style="border-top: solid 1px rgba(0,0,0,0.1); padding-left: 20px !important; padding-top: 10px !important; padding-bottom: 10px !important; border-bottom: solid 1px rgba(0,0,0,0.1) !important;">' +
                                                '<ul style="margin-bottom:0px;" class="icon-list">' +
                                                    '<li class="right-list">Cargo: ' + val['Cargo'] + ' </li>' +
                                                '</ul>' +
                                            '</a>' +
                                            '<a href="#" style="border-top: solid 1px rgba(0,0,0,0.1); padding-left: 20px !important; padding-top: 10px !important; padding-bottom: 10px !important; border-bottom: solid 1px rgba(0,0,0,0.1) !important;">' +
                                                '<ul style="margin-bottom:0px;" class="icon-list">' +
                                                    '<li class="right-list">Sector: ' + val['Sector'] + ' </li>' +
                                                '</ul>' +
                                            '</a>' +
                                            '<a href="#" style="border-top: solid 1px rgba(0,0,0,0.1); padding-left: 20px !important; padding-top: 10px !important; padding-bottom: 10px !important; border-bottom: solid 1px rgba(0,0,0,0.1) !important;">' +
                                                '<ul style="margin-bottom:0px;" class="icon-list">' +
                                                    '<li class="right-list">Profesión: ' + val['Profesion'] + ' </li>' +
                                                '</ul>' +
                                            '</a>' +
                                            '<a href="#" style="border-top: solid 1px rgba(0,0,0,0.1); padding-left: 20px !important; padding-top: 10px !important; padding-bottom: 10px !important; border-bottom: solid 1px rgba(0,0,0,0.1) !important;">' +
                                                '<ul style="margin-bottom:0px;" class="icon-list">' +
                                                    '<li class="right-list">Salario: ' + nom_sal + ' </li>' +
                                                '</ul>' +
                                            '</a>' +
                                            '<a href="#" style="border-top: solid 1px rgba(0,0,0,0.1); padding-left: 20px !important; padding-top: 10px !important; padding-bottom: 10px !important; border-bottom: solid 1px rgba(0,0,0,0.1) !important;">' +
                                                '<ul style="margin-bottom:0px;" class="icon-list">' +
                                                    '<li class="right-list">Experiencia: ' + nom_exp + ' </li>' +
                                                '</ul>' +
                                            '</a>' +
                                            '<a href="#" style="border-top: solid 1px rgba(0,0,0,0.1); padding-left: 20px !important; padding-top: 10px !important; padding-bottom: 10px !important; border-bottom: solid 1px rgba(0,0,0,0.1) !important;">' +
                                                '<ul style="margin-bottom:0px;" class="icon-list">' +
                                                    '<li class="right-list">Nivel: ' + nom_niv + ' </li>' +
                                                '</ul>' +
                                            '</a>' +
                                            '<a href="#" style="text-align:center !important; border-top: solid 1px rgba(0,0,0,0.1); padding-left: 20px !important; padding-top: 10px !important; padding-bottom: 10px !important; border-bottom: solid 1px rgba(0,0,0,0.1) !important;">' +
                                            'Comparta esta oportunidad de trabajo' +
                                                '<ul style="margin-bottom:0px;" class="icon-list">' +
                                                    '<li style="padding-left:0px !important;">' +
                                                        '<img src="images/misc/facebook.png" style="margin: 0px !important;" class="star" onclick="abrirPaginaFacebook(\'' + val['Titulo'] + '\', ' + val['ID'] + ')">' +
                                                        '<img src="images/misc/twitter.png" class="star" style="margin-left: 5px;" onclick="abrirPaginaTwitter(\'' + val['Titulo'] + '\', ' + val['ID'] + ')">' +
                                                    '</li>' +
                                                '</ul>' +
                                            '</a>' +
                                        '</div>' +
                                    '</div>' +
                                    '<div class="one-half-responsive" style="text-align:center !important;">' +
                                            '<div onclick=\"' + metodoFavorito + '\" style="width: 50%; float: left;"><img id="estrella' + val['ID'] + '" class="star" style="margin: 0px !important; width:auto !important;" src="' + rutaEstrella + '" style="width: 20px;" /><label>' + textoFavorita + '</label></div>' +
                                            '<div id="btnDen' + val['ID'] + '" style="padding-left: 20px; width: 50%; float: left;margin-top: 5px; display:block;"><a href="#" onclick="Denunciar(' + val['ID'] + ')" class="button-icon icon-setting button-red">Denunciar</a></div>' +
                                            '<div id="comboDen' + val['ID'] + '" style="padding-left: 20px; width: 50%; float: left;margin-top: 5px; display:none;">Motivo de la denuncia: <br />' +
                                            '<select class="styled-select" name="selectMotivoDenuncia' + val['ID'] + '" id="selectMotivoDenuncia' + val['ID'] + '">' +
                                            '<option value="1">Vacante sospechosa / engañosa</option>' +
                                            '<option value="2">Lenguaje no adecuado</option>' +
                                            '<option value="3">Información de contacto errónea </option>' +
                                            '<option value="4">Sospecha de Trata de personas</option>' +
                                        '</select>' +
                                        '<br /> <a href="#" onclick="GuardarDenuncia(' + val['ID'] + ')" class="button-icon icon-setting button-red">Confirmar denuncia</a>&nbsp;<a href="#" onclick="CancelarDenuncia(' + val['ID'] + ')" class="button-icon icon-setting button-red">Cancelar</a>' +
                                        '</div>' +
                                    '</div>' +
                                '</div>' +
                            '</div>' +
                        '</div>' +
                    '</div>' +
                    '</div>';
                }

                $("#ofertas").html(texto);

                $('.deploy-toggle-2').click(function () {
                    $(this).parent().find('.toggle-content').toggle(100);
                    $(this).toggleClass('toggle-2-active');
                    return false;
                });
                OcultarDivCargando();
            }
            else {
                abrirAlert("No existen vacantes favoritas agregadas.")
            }
        }

        function errorConsultarVacantes(err) {
            console.log(err);
            alert("Error consultando listado de vacantes" + err);
        }

        function cargarOfertas(palabra) {
            $("#map_canvas").hide();

            MostrarDivCargando();
            var vectorConectores = ["a", "ante", "bajo", "con", "contra", "de", "desde", "en", "entre", "hacia", "hasta", "para", "por", "según", "segun", "sin", "sobre", "tras", " ", "  ", "   ", ""];

            if (palabra != "") {
                palabra = palabra.trim();
                var palabrasSeparadas = palabra.split(" ");
                var fraseDefinitiva = "";
                var palabraAuxiliar = "";

                for (x = 0; x < palabrasSeparadas.length; x++) {
                    palabraAuxiliar = palabrasSeparadas[x];
                    palabrasSeparadas[x] = palabraAuxiliar.trim().toLowerCase();
                }

                fraseDefinitiva += palabrasSeparadas[0];

                for (x = 1; x < palabrasSeparadas.length; x++) {
                    if ($.inArray(palabrasSeparadas[x], vectorConectores) == -1) {
                        fraseDefinitiva += " AND ";
                        fraseDefinitiva += palabrasSeparadas[x];
                    }
                }

                palabra = fraseDefinitiva;
            }

            var texto = "";
            var ofertas = $("#ofertas");
            ofertas.empty();

            var nom_mun = localStorage.getItem('NombreMunicipio');
            var nom_sal = localStorage.getItem('NombreSalario');
            var nom_exp = localStorage.getItem('NombreExperiencia');
            var nom_niv = localStorage.getItem('NombreNivel');
            var municipio = localStorage.getItem('Municipio');
            var tipo = localStorage.getItem('Oportunidad');
            var salario = localStorage.getItem('Salario');
            var experiencia = localStorage.getItem('Experiencia');
            var nivel = localStorage.getItem('Nivel');
            var vacantesGuardadas = localStorage.getItem("vacantesGuardadas");
            $.ajax({
                url: 'http://apiempleo.apphb.com/api/Vacante/obtenerVacantes?palabra=' + palabra + '&tipo=' + tipo + '&salario=' + salario + '&experiencia=' + experiencia + '&nivel=' + nivel + '&municipio=' + municipio,
                type: 'POST',
                dataType: 'json',
                success: function (data, textStatus, xhr) {
                    
                },
                error: function (xhr, textStatus, errorThrown) {
                    //alert(errorThrown);
                    OcultarDivCargando();
                    alert("Ha ocurrido un problema, inténtelo nuevamente.");
                }
            });
        }

    </script>
</head>
<body>
    <div id="preloader">
        <div id="status">
            <p class="center-text">
                Cargando contenido... <em>La carga depende de su conexión a internet!</em>
            </p>
        </div>
    </div>
    <div class="all-elements">
        <div id="sidebar" class="page-sidebar">
            <div class="page-sidebar-scroll">
                <div class="sidebar-shortcuts">
                    <a href="#" class="shortcut-close"></a>
                </div>
                <div class="sidebar-search">
                    <div class="search-box">
                        <input type="text" class="search-field" name="search" onfocus="if(this.value == 'Looking for something?') { this.value = ''; }"
                               value="Looking for something?">
                        <a href="#" class="search-close"></a>
                    </div>
                </div>
                <div class="sidebar-logo">
                    <img src="images/logo_odc.png" height="52" alt="img">
                </div>
                <div class="sidebar-breadcrumb">
                    BUSCO EMPLEO
                </div>
                <div class="navigation-item">
                    <a href="index.html" class="nav-item home-icon">Oportunidades de empleo<em class="unselected-item"></em></a>
                </div>
                <div class="sidebar-decoration">
                </div>
                <div class="navigation-item">
                    <a href="vacantes_favoritas.html" class="nav-item home-favoritas">
                        Mis vacantes favoritas<em class="selected-item"></em>
                    </a>
                </div>
                <div class="sidebar-decoration">
                </div>
                <div class="sidebar-breadcrumb">
                    SOY EMPLEADOR
                </div>
                <div class="navigation-item">
                    <a href="#" class="nav-item home-admin submenu-deploy">
                        Sección del empleador<em class="dropdown-item"></em>
                    </a>
                    <div class="sidebar-decoration">
                    </div>
                    <div class="nav-submenu">
                        <a id="opc_Sesion" href="inicio-sesion.html">
                            Inicio sesion<em class="unselected-item"></em>
                        </a>
                        <a id="opc_Registrar" name="opc_Registrar" href="RegistrarOferta.html">
                            Publicar vacante nueva<em class="unselected-item"></em>
                        </a>
                        <a id="opc_VerMias" name="opc_VerMias" href="lista_ofertas_empleador.html">
                            Gestionar vacantes<em class="unselected-item"></em>
                        </a>
                    </div>
                </div>
                <div class="sidebar-decoration">
                </div>
                <div class="sidebar-breadcrumb">
                    INFORMACIÓN
                </div>
                <div class="navigation-item">
                    <a href="faqs.html" class="nav-item home-faqs">Preguntas Frecuentes<em class="unselected-item"></em></a>
                </div>
                <div class="sidebar-decoration">
                </div>
                <div class="navigation-item">
                    <a href="acerca.html" class="nav-item home-info-about">Acerca de<em class="unselected-item"></em></a>
                </div>
                <div class="sidebar-decoration">
                </div>
                <div class="sidebar-breadcrumb">
                    SERVICIO DE EMPLEO MÓVIL 2014
                </div>
            </div>
        </div>
        <div id="content" class="page-content">
            <div class="page-header" id="header">
                <a href="#" class="deploy-sidebar"></a>
                <img class="header-logo" src="images/texto_banner.png" width="71" alt="img">
            </div>
            <div class="page-header-clear">
            </div>
            <div class="content">
                <div class="decoration">
                </div>
                <div class="container no-bottom" style="text-align: center;">
                    <h3>
                        VACANTES FAVORITAS</h3>
                </div>
                <div class="decoration">
                </div>
                <div class="container no-bottom">
                    <div class="big-notification blue-notification">
                        <h4>
                            En esta sección encontrará la lista de vacantes pre-seleccionadas por usted y que todavía se encuentran vigentes”</h4>
                        <a href="#" class="close-big-notification">X</a>
                    </div>
                </div>
                <div class="decoration">
                </div>
                <div id="ofertas">
                </div>
                <div class="decoration">
                </div>
                <div class="container">
                    <div class="footer-socials" style="width:100%;">
                        <div style="float:left;width:50%;">
                            <a href="#" class="facebook-footer" style="float:right;"></a>
                        </div>
                        <div style="float:left;width:50%;">
                            <a href="#" class="twitter-footer" style="float:left;"></a>
                            <a href="#" class="goup-footer" style="float:right;"></a>
                        </div>
                    </div>
                    <p class="copyright uppercase center-text no-bottom">
                        SERVICIO DE EMPLEO MÓVIL 2014<br>
                        Todos los derechos reservados
                    </p>
                </div>
            </div>
        </div>
    </div>
    <div class="cuadro-internet-connection">
        <div id="div-internet-connection" class="circulo-internet-connection"></div>
        <label style="padding-left: 12px;" id="label-internet-connection">Online</label>
    </div>    
</body>
</html> 